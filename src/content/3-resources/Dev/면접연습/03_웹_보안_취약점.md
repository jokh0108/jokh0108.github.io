# 웹 보안과 관련된 취약점

## 질문
웹 보안과 관련된 주요 취약점과 대응 방법에 대해 설명해주세요.

## 답변
주요 웹 보안 취약점으로는 XSS(Cross-Site Scripting), CSRF(Cross-Site Request Forgery), SQL Injection, CORS 관련 취약점 등이 있습니다. 이를 방지하기 위해 사용자 입력 검증과 이스케이핑, CSP(Content Security Policy) 설정, HTTPS 사용, 인증 토큰 관리, 적절한 CORS 설정 등의 방법을 적용해야 합니다.

### 참고 자료
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [MDN: 웹 보안](https://developer.mozilla.org/ko/docs/Web/Security)

### 주요 취약점 도식화
```
┌────────────────────────────────────┐
│          주요 웹 보안 취약점         │
└───────────────────┬────────────────┘
            ┌───────┴───────┐
            │               │
            ▼               ▼
┌───────────────────┐ ┌────────────────────┐
│ 인젝션 공격       │ │ 인증 및 세션 관리   │
│ - SQL 인젝션      │ │ - 세션 하이재킹     │
│ - XSS            │ │ - 무차별 대입 공격   │
│ - 명령어 인젝션    │ │ - 자격 증명 노출    │
└───────────────────┘ └────────────────────┘
            │               │
            ▼               ▼
┌───────────────────┐ ┌────────────────────┐
│ CSRF             │ │ 보안 설정 오류       │
│ - 사이드 요청 위조 │ │ - CORS 설정 오류    │
│                   │ │ - HTTPS 미사용      │
│                   │ │ - 민감 정보 노출    │
└───────────────────┘ └────────────────────┘
```

## 꼬리 질문 1
Content Security Policy(CSP)란 무엇이며 어떻게 설정하나요?

### 답변
CSP는 XSS 같은 코드 인젝션 공격을 방지하는 보안 계층입니다. 서버에서 HTTP 헤더로 설정하거나 HTML의 meta 태그로 설정할 수 있습니다. CSP는 신뢰할 수 있는 콘텐츠 소스를 지정하여 브라우저가 해당 소스에서만 리소스를 로드하도록 제한합니다. 예: `Content-Security-Policy: default-src 'self'; script-src 'self' trusted-scripts.com`

### 참고 자료
- [MDN: Content Security Policy](https://developer.mozilla.org/ko/docs/Web/HTTP/CSP)
- [Google Web Fundamentals: CSP](https://developers.google.com/web/fundamentals/security/csp?hl=ko)

### CSP 설정 예시 도식화
```
┌─────────────────────────────────────────────────────────────┐
│ CSP 헤더 설정 예시                                           │
└─────────────────────────────────────────────────────────────┘

HTTP 헤더 설정:
Content-Security-Policy: default-src 'self'; 
                         script-src 'self' https://trusted-scripts.com; 
                         img-src 'self' https://trusted-images.com; 
                         style-src 'self' https://trusted-styles.com;
                         
HTML meta 태그 설정:
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; script-src 'self' https://trusted-scripts.com">

┌────────────────────┐     ┌────────────────────┐
│ 신뢰할 수 있는 소스 │     │ 차단된 소스        │
└─────────┬──────────┘     └─────────┬──────────┘
          │                          │
          ▼                          ▼
┌────────────────────┐     ┌────────────────────┐
│ - self (자체 도메인)│     │ - 인라인 스크립트  │
│ - trusted-scripts.com │   │ - eval() 함수     │
│ - trusted-images.com  │   │ - 허용되지 않은    │
│ - trusted-styles.com  │   │   외부 도메인      │
└────────────────────┘     └────────────────────┘
```

## 꼬리 질문 2
Same-Origin Policy와 CORS의 관계를 설명해주세요.

### 답변
Same-Origin Policy는 브라우저가 다른 출처(프로토콜, 도메인, 포트가 다른 경우)의 리소스에 접근하는 것을 제한하는 보안 정책입니다. CORS(Cross-Origin Resource Sharing)는 이 정책을 완화하여 서로 다른 출처 간 리소스 공유를 안전하게 허용하는 메커니즘입니다. 서버는 특정 HTTP 헤더를 추가하여 다른 출처의 요청을 허용할 수 있습니다.

### 참고 자료
- [MDN: Same-Origin Policy](https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy)
- [MDN: CORS](https://developer.mozilla.org/ko/docs/Web/HTTP/CORS)

### Same-Origin Policy와 CORS 도식화
```
┌─────────────────────┐      ┌─────────────────────┐
│ 브라우저            │      │ api.example.com      │
│ (app.example.com)   │      │ (다른 출처)          │
└────────┬────────────┘      └──────────┬──────────┘
         │                              │
         │    1. XHR/Fetch 요청         │
         │ --------------------------->  │
         │                              │
         │ 2. 브라우저가 Same-Origin     │
         │    Policy 적용                │
         │                              │
         │ 3. CORS 헤더 확인             │
         │                              │
         │    4. 응답 반환 (CORS 헤더 포함) │
         │ <---------------------------  │
         │                              │
         ▼                              ▼

┌─────────────────────────────────────────────────┐
│ CORS 헤더 예시:                                  │
│ Access-Control-Allow-Origin: app.example.com    │
│ Access-Control-Allow-Methods: GET, POST, PUT    │
│ Access-Control-Allow-Headers: Content-Type      │
└─────────────────────────────────────────────────┘
```

## 꼬리 질문 3
JWT(JSON Web Token)의 보안 취약점과 안전한 사용법은 무엇인가요?

### 답변
JWT 관련 주요 취약점으로는 토큰 탈취, 알고리즘 교체 공격, 서명 검증 미흡 등이 있습니다. 안전한 사용을 위해 HTTPS 사용, 적절한 만료 시간 설정, 중요 정보는 토큰 페이로드에 저장하지 않기, 강력한 서명 알고리즘(HS256 이상) 사용, 토큰 무효화 메커니즘 구현, 민감한 작업 시 추가 인증 요구 등의 방법을 적용해야 합니다.

### 참고 자료
- [OWASP: JSON Web Token 보안 가이드](https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html)
- [JWT.io: Introduction to JWT](https://jwt.io/introduction)

### JWT 구조 및 보안 도식화
```
┌─────────────────────────────────────────────────┐
│ JWT 구조                                         │
└──────────────────────┬──────────────────────────┘
                       │
     ┌─────────────────┼─────────────────┐
     │                 │                 │
     ▼                 ▼                 ▼
┌──────────┐     ┌──────────┐     ┌──────────┐
│ 헤더      │.    │ 페이로드  │.    │ 서명     │
│ (Header)  │     │ (Payload) │     │ (Signature)│
└──────────┘     └──────────┘     └──────────┘
     │                 │                 │
     ▼                 ▼                 ▼
┌──────────┐     ┌──────────┐     ┌──────────┐
│ - alg    │     │ - sub    │     │ HMACSHA256│
│ - typ    │     │ - iat    │     │ (헤더+페이로드│
└──────────┘     │ - exp    │     │  +비밀키)  │
                 │ - 사용자  │     └──────────┘
                 │   데이터  │
                 └──────────┘

┌─────────────────────────────────────────────────┐
│ JWT 보안 모범 사례                               │
└──────────────────────┬──────────────────────────┘
                       │
      ┌────────────────┴───────────────┐
      │                                │
      ▼                                ▼
┌──────────────────────┐    ┌──────────────────────┐
│ 토큰 설정            │    │ 전송 및 저장         │
│ - 짧은 만료 시간     │    │ - HTTPS 사용         │
│ - 강력한 서명 알고리즘│    │ - 쿠키에 저장 시     │
│ - 민감 정보 제외     │    │   httpOnly, secure   │
│ - 사용 범위 제한     │    │ - localStorage 위험성│
└──────────────────────┘    └──────────────────────┘
``` 
